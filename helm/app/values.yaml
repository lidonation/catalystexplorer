
replicaCount: 1

namespace: catalystexplorer-preview

image:
  repository: registry.lidonation.com/lidonation/www.catalystexplorer.com/web-app
  tag: 'latest'
  pullPolicy: IfNotPresent
  pullSecret:  gitlab-registry-catalystexplorer

services:
  app:
    replicaCount: 1
    environment: 'preview'
    POSTGRESQL_WEB_DB_HOST: 
    storageClass: longhorn
    image:
      repository: registry.lidonation.com/lidonation/www.catalystexplorer.com/web-app
      tag: latest
      pullPolicy: IfNotPresent
      pullSecret:  gitlab-registry-catalystexplorer-www-catalystexplorer-com
    persistence:
      size: 40Gi
      storageClass: longhorn
      accessMode: ReadWriteMany
      subPath: "uploads"
      mountPath: "/var/www/storage/app"
  db:
    monitoring:
      enabled: true
    bootstrap:
      database:
        database: catalystexplorer
        owner: explorerdbuser
      enablePgvector: true
    migration:
      enabled: true
      sourceHost: cx-web-db-postgresql-ha-pgpool
      sourcePort: "5432"
      sourceUser: postgres
      sourcePassword:
      sourceDatabase: catalystexplorer
    secrets:
      DB_NAME: catalystexplorer
      DB_USERNAME: explorerdbuser
      DB_PASSWORD:
      DEFAULT_REGION: us-east-1
      POSTGRES_USER: postgres
      POSTGRES_USER_PASSWORD:
  queue:
    replicaCount: 1
  ollama:
    enabled: false
    replicaCount: 1
    model: "llama3.3:70b"
    keepAlive: "24h"
    
    image:
      repository: ollama/ollama
      tag: "0.6.2"
      pullPolicy: IfNotPresent
    
    service:
      type: ClusterIP
      port: 11434
    
    resources:
      limits:
        memory: 96Gi
        cpu: "12"
      requests:
        cpu: "2"
        memory: 16Gi
    
    persistence:
      size: 250Gi
      storageClass: longhorn
    
    # GPU configuration (set to true if GPU nodes are available)
    gpu:
      enabled: false
    
    # Node placement preferences
    nodeSelector: {}
    
    # Tolerations for dedicated nodes
    tolerations: []
    
    # Affinity rules
    affinity: {}

  meili:
    MEILISEARCH_KEY:
    persistence:
      size: "320Gi"
      storageClass: longhorn
  redis:
    password: 
    host: redis-headless

backup:
  schedule:
    cron: "0 2 * * *"  # Daily at 2am
